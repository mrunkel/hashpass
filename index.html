<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Hashpass</title>
    <!-- Bootstrap -->
    <link rel="stylesheet" href="css/bootstrap.css">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="css/bootstrap-theme.css">
    <!-- vue -->
    <script src="https://vuejs.org/js/vue.js"></script>
</head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">Password Hasher</a>
        </div>
    </div>
</nav>


<br>
<div id="hash" class="jumbotron">
    <div class="container">
        <p>Submit the password you'd like to hash. You can optionally add a salt value, but we've already generated one for
        you.</p>
        <div class="form-group">
            <label for="password1">Passwords</label>
            <input type="password" v-model="password1" placeholder="Password" id="password1">
            <input type="password" v-model="password2" placeholder="Repeat Password" id="password2">
        </div>
        <div class="form-group">
            <label for="salt">Salt</label>
            <input type="text" v-model="salt" id="salt">
        </div>
        <p class="alert-warning">Note: Entering a manual salt is not recommended!</p>
    </div>

    <div class="container">
        <p>The resulting hash (including the salt) is: <br><br>{{ hashedPassword }}<br><br> Please email this to the person
        that requested the hash.</p>
    </div>
    <div class="container">
        <p> Bonus: Here is the mysql compatible hash of the same password: {{ mysqlPassword }}</p>
    </div>
</div>


<P>
    <!-- include crypto libraries.  crypto-js for sha1, sha512* for sha512crypt
        if I was a little smarter/less lazy, I could use crypto-js for both, but
        meh. -->
    <script src="js/crypto-js.js"></script>
    <script src="js/sha512.js"></script>
    <script src="js/sha512crypt.js"></script>

    <script type="text/javascript">

        // Shortcuts

        var enc = CryptoJS.enc;
        var sha1 = CryptoJS.SHA1;

        function generateSalt(len) {
            var valid = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ" +
                "abcdefghijklmnopqrstuvwxyz./-+_";

            var salt = "";
            for (var i = 0; i < len; ++i) {
                salt += valid.charAt(Math.floor(Math.random() * valid.length));
            }

            return salt

        }

        var hash = new Vue({
            el: '#hash',
            data: {
                salt: generateSalt(16),
                password1: "",
                password2: "",
            },
            computed: {
                hashedPassword: function () {
                    if ((this.password1 !== this.password2) || this.password1 === "") {
                        return ""
                    } else {
                        return sha512crypt(this.password1, this.salt)
                    }
                },
                mysqlPassword: function () {
                    if ((this.password1 !== this.password2) || this.password1 === "") {
                        return ""
                    } else {
                        return sha1(sha1(this.password1)).toString(enc.Hex).toUpperCase()
                    }
                }
            }
        })
    </script>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
</body>
</html>